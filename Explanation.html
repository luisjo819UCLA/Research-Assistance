<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
padding-top: 0px;
}
</style>


</head>

<body>

<h1 id="ra-luis-zapata---phd-luca---anderson-school-of-economics">RA
Luis Zapata - PHD Luca - Anderson School of Economics</h1>
<h2 id="explanation-of-code">Explanation of Code</h2>
<p>I will be utilizing matched employer-employee data from Germany. In
this <a href="https://fdz.iab.de/en/int_bd_pd/the-sample-of-integrated-employer-employee-data-sieed-sieed-7518-version-1/">link</a>,
you can find a description of the dataset. Specifically, there is a file
at the link containing a detailed description of the data (<a href="https://doku.iab.de/fdz/reporte/2020/DR_14-20_EN.pdf">this</a>)
and the test data, which is a fake data. Unfortunately, access to the
real data is restricted due to confidentiality constraints associated
with the dataset.</p>
<p>This <a href="https://davidcard.berkeley.edu/papers/QJE-2013.pdf">paper</a> is
an excellent piece that utilizes the same dataset, implementing certain
methodologies and approaches that I aim to replicate or use as a
foundation for my analysis. Additionally, the paper discusses some
issues with the dataset, including the fact that wages are capped. When
wages exceed a specific threshold, they are recorded as the threshold
value. The authors employ a methodology to estimate the actual wage
beyond the threshold, and I plan to adopt a similar approach. The
initial task will involve replicating their code, translating it into
either R.</p>
<h2 id="data-sets-managment">Data Sets managment</h2>
<p>The documentation containts information about the datasets that
contain yearly data and those that involve worker flows and
establishment dynamics such as entries, exits, inflows, and outflows.
Here is a breakdown:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Datasets with Years in Their Name</strong>: These
datasets are annual files that contain variable blocks with data from
each year from 1975 to 2018. They are named using the format
<code>SIEED_7518_v1_bhp_v1_jjjj.dta</code>, where <code>jjjj</code>
represents the specific year (e.g., <code>1975</code>,
<code>2016</code>, etc.). Each file corresponds to a particular year and
includes data up to the reference date of June 30th for that
year.</p></li>
<li><p><strong>Datasets with Entry, Exit, Inflow, and Outflow in Their
Names</strong>: These datasets specifically contain information about
the dynamics of the workforce within establishments:</p>
<ul>
<li><p><strong>Entries
(<code>SIEED_7518_v1_bhp_entry_v1.dta</code>)</strong>: This file
contains data about the entries into establishments, which could be
indicative of the creation of new positions or filling of existing
ones.</p></li>
<li><p><strong>Exits
(<code>SIEED_7518_v1_bhp_exit_v1.dta</code>)</strong>: This file
includes data on exits from establishments, which might reflect layoffs,
terminations, or retirements.</p></li>
<li><p><strong>Inflows
(<code>SIEED_7518_v1_bhp_inflow_v1.dta</code>)</strong>: This dataset
captures the inflow of employees to establishments, providing insights
into hiring trends.</p></li>
<li><p><strong>Outflows
(<code>SIEED_7518_v1_bhp_outflow_v1.dta</code>)</strong>: Conversely,
this dataset records the outflow of employees from establishments, which
could inform on turnover rates and employment stability.</p></li>
</ul></li>
</ol>
<p>These datasets can be accessed and used following an approved
application for research purposes and are essential for analyzing
employment trends and patterns within establishments over time. The
merging of individual-level and establishment-level data within
statistical software such as Stata is necessary to perform comprehensive
analyses. The datasets are meant to be linked via identifiers like the
establishment number and the reference year.</p>
<h2 id="structure-of-the-data">Structure of the Data</h2>
<p>The documentation describe the dataset subsets and how to use them,
particularly in the context of the Sample of Integrated
Employer-Employee Data (SIEED). These subsets are designed to be used in
conjunction with one another and are linked via specific identifiers
such as establishment numbers and individual IDs.</p>
<p>Here’s a brief overview of the structure and use of the dataset
subsets as explained in the PDF:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Basis Establishment File</strong>: Contains the
establishment number, the year, and aggregated variables about the place
of work and economic activities as of the reference date, 30 June. It is
meant to be linked with the Individual File for comprehensive
analysis.</p></li>
<li><p><strong>Individual File</strong>: Includes personal identifiers,
personal variables, information on employment, and place of residence,
among other details.</p></li>
<li><p><strong>Episode Splitting</strong>: The process of dealing with
overlapping observations within an account by creating artificial
observations with new dates, leading to non-overlapping
periods.</p></li>
<li><p><strong>Sampling Procedure</strong>: Outlines the steps taken to
select a sample of establishments and individuals for inclusion in the
SIEED.</p></li>
<li><p><strong>Data Use</strong>: Describes the conditions under which
the SIEED data may be accessed and analyzed, including research visits
and remote data access following application approval by the
FDZ.</p></li>
<li><p><strong>File Architecture</strong>: Discusses how data are stored
in separate files for individual and establishment-related information,
and that additional files with more detailed establishment information
can be provided upon justified application.</p></li>
</ol>
<p>To use the data, researchers are advised to <strong>merge the
individual-level and establishment-level</strong> data within their
statistical software.</p>
<p>It is suggested to merge the datasets based on establishment numbers
and the year, which should correspond between the individual and
establishment files.</p>
<p>Each subset of the SIEED data has a specific role and, when combined,
can provide a comprehensive view of employment biographies and
establishment characteristics.</p>
<p>For more inquiries about the data, go to the documentation link
provided above.</p>
<h2 id="preparing-the-data">Preparing the Data</h2>
<p>We beggin by calling the libraries as follow:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(data.table) <span class="co">#Table data handler</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(censReg)  <span class="co"># For Tobit regression</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co">#Also data handler</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(tidyverse,<span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co">#For data managment</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(lubridate)  <span class="co"># For easy date handling</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(haven) <span class="co"># For reading Stata files</span></span></code></pre></div>
<h2 id="call-the-data">Call the data</h2>
<p>We call the Stata data (.dta) from our folder and store it in a
list.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>dta_files <span class="ot">=</span> <span class="fu">list.files</span>(<span class="st">&quot;SIEED_7518_v1_test&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;.dta&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>dta_list <span class="ot">=</span> <span class="fu">lapply</span>(dta_files, <span class="cf">function</span>(x) <span class="fu">read_dta</span>(<span class="fu">paste0</span>(<span class="st">&quot;SIEED_7518_v1_test/&quot;</span>, x)))</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">class</span>(dta_list))</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<p>I now print the last 10 rows of the list to see what kind of data we
are dealing with.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">tail</span>(dta_files, <span class="dv">10</span>))</span></code></pre></div>
<pre><code>##  [1] &quot;SIEED_7518_v1_bhp_2015_v1.dta&quot;    &quot;SIEED_7518_v1_bhp_2016_v1.dta&quot;   
##  [3] &quot;SIEED_7518_v1_bhp_2017_v1.dta&quot;    &quot;SIEED_7518_v1_bhp_2018_v1.dta&quot;   
##  [5] &quot;SIEED_7518_v1_bhp_basis_v1.dta&quot;   &quot;SIEED_7518_v1_bhp_entry_v1.dta&quot;  
##  [7] &quot;SIEED_7518_v1_bhp_exit_v1.dta&quot;    &quot;SIEED_7518_v1_bhp_inflow_v1.dta&quot; 
##  [9] &quot;SIEED_7518_v1_bhp_outflow_v1.dta&quot; &quot;SIEED_7518_v1.dta&quot;</code></pre>
<p>We can see that the data have one kind related with years, while the
others have the names: basis, entry, exit, infow and outflow associated
with them.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">#On dta_files there are data with year on the name, and other without it.</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#Lets filter the ones with year on the name</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>dta_files_2 <span class="ot">&lt;-</span> dta_files[<span class="fu">str_detect</span>(dta_files, <span class="st">&quot;^(SIEED_7518_v1_bhp_20|SIEED_7518_v1_bhp_19)&quot;</span>)]</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>dta_files_3 <span class="ot">&lt;-</span> dta_files[<span class="sc">!</span>dta_files <span class="sc">%in%</span> dta_files_2]</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="fu">print</span>(dta_files_3)</span></code></pre></div>
<pre><code>## [1] &quot;SIEED_7518_v1_bhp_basis_v1.dta&quot;   &quot;SIEED_7518_v1_bhp_entry_v1.dta&quot;  
## [3] &quot;SIEED_7518_v1_bhp_exit_v1.dta&quot;    &quot;SIEED_7518_v1_bhp_inflow_v1.dta&quot; 
## [5] &quot;SIEED_7518_v1_bhp_outflow_v1.dta&quot; &quot;SIEED_7518_v1.dta&quot;</code></pre>
<p>We know merge all the data that are related with the yeards 2019 and
2020.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>dta_year <span class="ot">=</span> <span class="fu">tibble</span>(<span class="st">&quot;Address&quot;</span> <span class="ot">=</span> dta_files_2) <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;Year&quot;</span> <span class="ot">=</span> <span class="fu">str_sub</span>(Address, <span class="at">start =</span> <span class="dv">19</span>, <span class="at">end =</span> <span class="dv">22</span>))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#We extract the year, wich is the second four digits of the file name</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#Lets read all the dta in the Address column and store them in a list. Lets name the list with the year of the data</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>dta_list_2 <span class="ot">=</span> <span class="fu">lapply</span>(dta_files_2, <span class="cf">function</span>(x) <span class="fu">read_dta</span>(<span class="fu">paste0</span>(<span class="st">&quot;SIEED_7518_v1_test/&quot;</span>, x)))</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="fu">names</span>(dta_list_2) <span class="ot">=</span> dta_year<span class="sc">$</span>Year</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#Lets merge all the data in dta_list_2, in order to create one big tibble. We also create one column with name &quot;Year&quot; to store the year of the data</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>dta_list_2 <span class="ot">=</span> dta_list_2 <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">&quot;Year&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Year)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The size of the data is: rows:&quot;</span>, <span class="fu">nrow</span>(dta_list_2), <span class="st">&quot; and columns:&quot;</span>, <span class="fu">ncol</span>(dta_list_2)))</span></code></pre></div>
<pre><code>## [1] &quot;The size of the data is: rows: 197898  and columns: 10&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(dta_list_2,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 10
##   betnr      jahr az_f    az_reg az_azubi az_atz az_tz az_f_vz az_f_tz az_reg_vz
##   &lt;dbl+lbl&gt; &lt;dbl&gt; &lt;dbl+l&gt; &lt;dbl+&gt; &lt;dbl+lb&gt; &lt;dbl+&gt; &lt;dbl&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+lbl&gt;
## 1 49914458   1975  4        9    3        0      0      3      0         9      
## 2 49916216   1975 60      155    1        0      0     59      0       155      
## 3 49916399   1975  7      255    2        0      3      5      2       252</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">glimpse</span>(dta_list_2))</span></code></pre></div>
<pre><code>## Rows: 197,898
## Columns: 10
## $ betnr     &lt;dbl+lbl&gt; 49914458, 49916216, 49916399, 49916406, 49916493, 499178…
## $ jahr      &lt;dbl&gt; 1975, 1975, 1975, 1975, 1975, 1975, 1975, 1975, 1975, 1975, …
## $ az_f      &lt;dbl+lbl&gt;   4,  60,   7,   4,   0,  28,  10,  96,   1,   2,   4,  …
## $ az_reg    &lt;dbl+lbl&gt;    9,  155,  255,    3,    3,   53,  114,  154,    1,   …
## $ az_azubi  &lt;dbl+lbl&gt;  3,  1,  2,  1,  0,  2, 18,  3,  0,  0,  0,  0, 28,  0, …
## $ az_atz    &lt;dbl+lbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ az_tz     &lt;dbl+lbl&gt;  0,  0,  3,  2,  0, 11,  5,  1,  0,  0,  1,  0, 50,  0, …
## $ az_f_vz   &lt;dbl+lbl&gt;   3,  59,   5,   1,   0,  16,   4,  93,   1,   2,   3,  …
## $ az_f_tz   &lt;dbl+lbl&gt;  0,  0,  2,  2,  0, 10,  5,  1,  0,  0,  1,  0, 50,  0, …
## $ az_reg_vz &lt;dbl+lbl&gt;   9, 155, 252,   1,   3,  42, 109, 153,   1,   2,   6,  …
## # A tibble: 197,898 × 10
##    betnr      jahr az_f   az_reg az_azubi az_atz az_tz az_f_vz az_f_tz az_reg_vz
##    &lt;dbl+lbl&gt; &lt;dbl&gt; &lt;dbl+&gt; &lt;dbl+&gt; &lt;dbl+lb&gt; &lt;dbl+&gt; &lt;dbl&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+lbl&gt;
##  1 49914458   1975  4       9     3       0       0     3       0        9      
##  2 49916216   1975 60     155     1       0       0    59       0      155      
##  3 49916399   1975  7     255     2       0       3     5       2      252      
##  4 49916406   1975  4       3     1       0       2     1       2        1      
##  5 49916493   1975  0       3     0       0       0     0       0        3      
##  6 49917890   1975 28      53     2       0      11    16      10       42      
##  7 49918306   1975 10     114    18       0       5     4       5      109      
##  8 49918999   1975 96     154     3       0       1    93       1      153      
##  9 49919426   1975  1       1     0       0       0     1       0        1      
## 10 49919628   1975  2       2     0       0       0     2       0        2      
## # ℹ 197,888 more rows</code></pre>
<p>We still have to understand better the way the data is gathered. We
have to read the documentation in order to do it.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">print</span>(dta_files_3)</span></code></pre></div>
<pre><code>## [1] &quot;SIEED_7518_v1_bhp_basis_v1.dta&quot;   &quot;SIEED_7518_v1_bhp_entry_v1.dta&quot;  
## [3] &quot;SIEED_7518_v1_bhp_exit_v1.dta&quot;    &quot;SIEED_7518_v1_bhp_inflow_v1.dta&quot; 
## [5] &quot;SIEED_7518_v1_bhp_outflow_v1.dta&quot; &quot;SIEED_7518_v1.dta&quot;</code></pre>

</body>
</html>
